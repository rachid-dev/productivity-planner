<div class="container my-5">
  <pre>{{ store.mode() }}</pre>
  <div class="row align-items-center mb-4">
    <div class="col-md-4"></div>
    <div class="col-md-4 text-center">
      <h6 class="mb-2">Working Day</h6>
      <input
        type="date"
        class="form-control"
        [value]="store.date()"
        (change)="store.updateDate($event)"
        [disabled]="store.isExecutionMode()"
      />
      @if (store.isExecutionMode()) {
        <div class="d-flex flex-column align-items-center mt-2">
          <div
            class="progress w-100"
            style="height: 1rem"
            data-testid="workday-progress"
          >
            <div
              class="progress-bar bg-success"
              role="progressbar"
              [style.width.%]="store.progress()"
              aria-valuenow="{{ store.progress() }}"
              aria-valuemin="0"
              aria-valuemax="100"
            >
              {{ store.progress() }}%
            </div>
          </div>
          <p class="small text-muted mt-2 text-center w-100">
            {{ store.progress() / 10 }} seconds have passed.
          </p>
        </div>
      }
    </div>
    @if (store.hasTaskPlanned() && store.isEditMode()) {
      <div
        class="col-md-4 text-end mt-3 mt-md-0"
        data-testid="start-workday-button"
      >
        <button
          class="btn btn-success rounded-pill px-4 py-2 fw-bold"
          (click)="store.startworkday()"
        >
          Start the work day
        </button>
      </div>
    }
  </div>

  @if (store.hasNoTaskPlanned()) {
    <div class="text-center my-5" data-testid="inbox-zero-placeholder">
      <img
        src="images/productivity-planner-inbox-zero.gif"
        alt="Inbox zero"
        class="img-fluid mx-auto"
      />
      <p class="mt-3 text-muted">Aucune tâche prévue pour aujourd'hui !</p>
    </div>
  }
  @for (task of store.taskList(); track $index) {
    @if ($index === 0) {
      <h6 class="mb-3 text-muted">Most important task</h6>
    }
    @if ($index === 1) {
      <h6 class="mb-3 text-muted">Tâches de seconde importance</h6>
    }
    @if ($index === 3) {
      <h6 class="mb-3 text-muted">Tâches restantes</h6>
    }
    @if (store.isEditMode()) {
      <app-task-field
        class="p-3 mb-3"
        [task]="task"
        [index]="$index"
        (taskUpdated)="store.updateTask($index, $event)"
        (taskRemoved)="store.removeTask($index)"
      />
    }
    @if (store.isExecutionMode()) {
      <app-task-readonly [task]="task" [index]="$index" />
    }
  }

  <div class="text-center">
    @if (store.isButtonDisplayed()) {
      <button
        data-testid="add-task-button"
        class="btn btn-link text-muted"
        (click)="store.addTask()"
      >
        Ajouter une tâche
      </button>
    }
  </div>
</div>
